<?php/*//* overlay   plugin 1.0* Joomla plugin* by Purple Cow Websites* @copyright Copyright (C) 2010 * Livefyre All rights reserved.// Create a category selector//*////////////function getHmacsha1Signature($key, $data) {	//convert binary hash to BASE64 string	return base64_encode(hmacsha1($key, $data));}function hmacsha1($key,$data) {	$blocksize=64;	$hashfunc='sha1';	if (strlen($key)>$blocksize) {		$key=pack('H*', $hashfunc($key));	}	$key=str_pad($key,$blocksize,chr(0x00));	$ipad=str_repeat(chr(0x36),$blocksize);	$opad=str_repeat(chr(0x5c),$blocksize);	$hmac = pack( 'H*',$hashfunc( ($key^$opad).pack( 'H*',$hashfunc( ($key^$ipad).$data ) ) ) );	return $hmac;}$sitePath = JPATH_SITE;$siteUrl  = substr(JURI::root(), 0, -1);   $site_url = substr(JURI::root(), 0, -1);$joomla_version = '1.5'; //echo $site_url;$plugin =& JPluginHelper::getPlugin('content', 'livefyre');$pluginParams = new JParameter( $plugin->params );$blogid = $pluginParams->get( 'blogid' );$site_key = $pluginParams->get( 'apisecret' );$lf_domain = $pluginParams->get( 'domain' );//Livefyre vars$livefyre_http_domain = 'livefyre.com';$livefyre_site_domain = "rooms.$livefyre_http_domain";$livefyre_http_url = "http://$livefyre_http_domain";$current_page_url = 'http://'.$_SERVER['SERVER_NAME'].$_SERVER['REQUEST_URI'];$isEnabled = JPluginHelper::isEnabled('content', 'livefyre');if (!isset($blogid) || $blogid == '' || !isset($lf_domain) || $lf_domain == '') {?><div id="lf-missing-blogid" style="border:1px solid #f00; color:#f00; padding:0 10px;">	<p>All fields must be filled out.</p></div><?php } ?><?php// no direct accessdefined('_JEXEC') or die('Restricted access');// Create a category selectorclass JElementCategories extends JElement {	var	$_name = 'categories';		function fetchElement($name, $value, &$node, $control_name){		echo 'hello';		$db = &JFactory::getDBO();			$categories=array();				// Create the 'all categories' listing		$categories[0]->id = '';		$categories[0]->title = JText::_($blogid);				// Create category listings, grouped by section						echo $query = 'SELECT id,title FROM nfxog_categories ';			$db->setQuery( $query );				$results = $db->loadObjectList();			array_push($categories);			foreach ($results as $result) {				array_push($categories,$result);			}						// Create the 'Uncategorised' listing		$optgroup = JHTML::_('select.optgroup',JText::_("Uncategorised"),'id','title');		array_push($categories,$optgroup);		$uncategorised=array();		$uncategorised['id'] = '0';		$uncategorised['title'] = JText::_("Uncategorised");		array_push($categories,$uncategorised);		// Output		return JHTML::_('select.genericlist',  $categories, ''.$control_name.'['.$name.'][]', 'class="inputbox" style="width:90%;" multiple="multiple" size="12"', 'id', 'title', $value );	}	} // end class